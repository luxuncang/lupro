<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>lupro.HTTPengine API documentation</title>
<meta name="description" content="lupro HTTP" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>lupro.HTTPengine</code></h1>
</header>
<section id="section-intro">
<p>lupro HTTP</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#39;&#39;&#39;
lupro HTTP
&#39;&#39;&#39;

from gevent import monkey
monkey.patch_all()  # 先引用
import gevent
from .config import HTTP_ENGINE, PROXIES, RUNFILE, VERIFY_PROXIES
from .config import verify_proxies, logging, get_proxies, get_header
from .hooks import lupros
from .publictool import inherit, original, endurance
from .analyzesController import analyze
from .typing import Response
import os
import random
import requests
import httpx
from copy import copy
from datetime import datetime

# &#39;HTTP 引擎&#39;
class engine():
    &#39;&#39;&#39;HTTP 引擎&#39;&#39;&#39;

    # requests
    @staticmethod
    def requests(self) -&gt; Response:
        &#39;&#39;&#39;`engine.requests` 为 `requests` 请求接口&#39;&#39;&#39;
        res = requests.request(*self.args, **self.kw)
        return res

    # httpx
    @staticmethod
    def httpx(self):
        &#39;&#39;&#39;`engine.httpx` 为 `requests` 请求接口&#39;&#39;&#39;
        res = requests.request(*self.args, **self.kw)
        return res


# `lupro` 引擎基类
class lupro(metaclass = inherit):
    &#39;&#39;&#39;`lupro` 引擎基类&#39;&#39;&#39;

    # 兼容 `requests`
    __general__ = HTTP_ENGINE

    # 当前文件夹
    onFile = RUNFILE

    # 代理池
    Proxies = PROXIES

    # 是否验证代理池
    VERIFY_PROXIES = VERIFY_PROXIES

    # 是否已验证代理
    IS_AGENT_VERIFIED = False

    def __init__(self, filename : str, lupros : lupros, proxie : bool = False, format : str = &#39;html&#39;, content : int = 200,faultolt : int = 10):
        &#39;&#39;&#39; 初始化 `lupro` 实例，一个实例代表一个请求或任务.

        Args:
            `filename` : `str` 文件路径或请求名称 推荐使用路径命名
            `lupros` : `lupros` requests参数字典
            `proxie` : `bool` 是否使用代理
            `format` : `str` 保存文件格式
            `content` : `int` 回调最少字节
            `faultolt` : `int` 可重试次数
        
        Returns:
            None
        &#39;&#39;&#39;
        self.filename = filename    # 文件路径或请求名称 推荐使用路径命名
        self.format = format        # 保存文件格式
        self.faultolt = faultolt    # 可重试次数
        self.proxie = proxie        # 是否使用代理
        self.content = content      # 回调最少字节
        self.lupros = lupros
        self.args = (lupros[0],*lupros[1])
        self.kw = copy(lupros[2])

        if (not lupro.Proxies) and self.proxie:
            lupro.Proxies = get_proxies()

        assert (not self.proxie) or (self.proxie and lupro.Proxies),&#39;`Proxies` cannot be empty!&#39;

        if not &#39;headers&#39; in self.kw:
            self.kw[&#39;headers&#39;] = {&#39;User-Agent&#39; : get_header()}
        elif not &#39;User-Agent&#39; in self.kw[&#39;headers&#39;]:
            self.kw[&#39;headers&#39;].update({&#39;User-Agent&#39; : get_header()})
        
        if lupro.VERIFY_PROXIES and self.proxie and (not lupro.IS_AGENT_VERIFIED):
            print(logging(&#39;开始验证代理！&#39;))
            t1 = datetime.now()
            self.authentication()
            lupro.IS_AGENT_VERIFIED = True
            print(logging(f&#39;用时{datetime.now() - t1}&#39;))
            print(logging(f&#34;高质量代理：{len(lupro.Proxies)}个！&#34;))

        if (not &#39;proxies&#39; in self.kw) and self.proxie:
            self.proxie = random.choice(lupro.Proxies)
            self.kw[&#39;proxies&#39;] = {&#39;http&#39;: f&#34;//{self.proxie}&#34;}
    
    # 验证代理
    def authentication(self) -&gt; None:
        &#39;&#39;&#39;`authentication` 为快速代理验证.&#39;&#39;&#39;

        auth_proxies = [gevent.spawn(verify_proxies, i) for i in lupro.Proxies]
        gevent.joinall(auth_proxies)
        lupro.Proxies = [i.value for i in auth_proxies if i.value]

    # 更新字典
    def renew_proxie(self):
        &#39;&#39;&#39;lupro实例 更新字典&#39;&#39;&#39;
        lupro.Proxies.remove(self.proxie)
        self.proxie = random.choice(lupro.Proxies)
        if lupro.__general__.__name__ == &#39;requests&#39;:
            self.kw[&#39;proxies&#39;] = {&#39;http&#39;: f&#34;//{self.proxie}&#34;}
        elif lupro.__general__.__name__ == &#39;httpx&#39;:
            self.kw[&#39;proxies&#39;] = {&#39;http://&#39;: f&#34;http://{self.proxie}&#34;}

    # 请求方法 lupro 所有请求
    @endurance
    def task(self):
        &#39;&#39;&#39;请求方法 lupro 所有请求接口&#39;&#39;&#39;
        def ask(self):
            if self.faultolt &lt;= 0:
                print(f&#39;{self.filename} failed.&#39;)
                return None
            print(logging(f&#34;{self.filename} {self.proxie} -----&gt; 开始请求！&#34;))
            try:
                res = getattr(engine, lupro.__general__.__name__)(self)
            except:
                if self.proxie and self.proxie in lupro.Proxies:
                    self.renew_proxie()
                self.faultolt -= 1
                print(logging(f&#34;{self.filename} -----&gt; 更新字典中！{self.faultolt}&#34;))
                return ask(self)
            if not res.status_code == 200:
                return ask(self)
            if len(res.content) &lt; self.content:
                return ask(self)
            print(logging(f&#34;{self.filename} {len(res.content)} -----&gt; 请求结束！&#34;)) 
            return res     
        return ask(self)
    
    # xpath 解析
    def xpath_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 xpath 解析方法.

        Args:
            `analytic` : `dict[str:str]` xpath解析字典
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.xpath(res, analytic, auxiliary)

    # json 解析
    def json_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 json 解析方法.

        Args:
            `analytic` : `dict[str:str]` xpath解析字典
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.json(res, analytic, auxiliary)

    # 正则 解析
    def re_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 正则 解析方法.

        Args:
            `analytic` : `dict`{`str`:`function`} 正则解析字典 
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.re(res, analytic, auxiliary)

    # css 解析
    def css_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 css 解析方法.

        Args:
            `analytic` : `dict[str:str]` css解析字典
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.css(res, analytic, auxiliary)

    # 保存文件路径
    def save_file(self) -&gt; str:
        &#39;&#39;&#39;保存文件方法，如果 `filename` 不为绝对路径,则保存文件的路径为当前目录&#39;&#39;&#39;

        res = self.task()
        if not res:
            return &#39;&#39;
        if os.path.isabs(self.filename):
            path = os.path.split(self.filename)[0]
        else:
            path = os.path.join(self.onFile,os.path.split(self.filename)[0])
        if not os.path.exists(path):
            os.makedirs(path)
        path = os.path.join(path,os.path.split(self.filename)[1]+f&#39;.{self.format}&#39;)
        if res.apparent_encoding == None:
            res.encoding = &#39;utf-8&#39;
        else:
            res.encoding = res.apparent_encoding
        with open(path,mode=&#39;wb&#39;) as f:
            f.write(res.content)
        return path

    def __repr__(self) -&gt; str:
        return f&#34;&lt;{__name__}.lupro({lupro.__general__.__name__}) object {self.filename}&gt;&#34;

    def __reprs__(self) -&gt; dict:
        &#39;&#39;&#39; `__reprs__` 为 `lupro` 实例化参数&#39;&#39;&#39;
        return {&#39;filename&#39;:self.filename ,&#39;format&#39;:self.format , &#39;proxie&#39;:self.proxie, &#39;faultolt&#39;:self.faultolt, &#39;content&#39; : self.content ,&#39;lupros&#39;:self.lupros}

    
    </code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="lupro.HTTPengine.engine"><code class="flex name class">
<span>class <span class="ident">engine</span></span>
</code></dt>
<dd>
<div class="desc"><p>HTTP 引擎</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class engine():
    &#39;&#39;&#39;HTTP 引擎&#39;&#39;&#39;

    # requests
    @staticmethod
    def requests(self) -&gt; Response:
        &#39;&#39;&#39;`engine.requests` 为 `requests` 请求接口&#39;&#39;&#39;
        res = requests.request(*self.args, **self.kw)
        return res

    # httpx
    @staticmethod
    def httpx(self):
        &#39;&#39;&#39;`engine.httpx` 为 `requests` 请求接口&#39;&#39;&#39;
        res = requests.request(*self.args, **self.kw)
        return res</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="lupro.HTTPengine.engine.httpx"><code class="name flex">
<span>def <span class="ident">httpx</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="lupro.HTTPengine.engine.httpx" href="#lupro.HTTPengine.engine.httpx">engine.httpx()</a></code> 为 <code>requests</code> 请求接口</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def httpx(self):
    &#39;&#39;&#39;`engine.httpx` 为 `requests` 请求接口&#39;&#39;&#39;
    res = requests.request(*self.args, **self.kw)
    return res</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.engine.requests"><code class="name flex">
<span>def <span class="ident">requests</span></span>(<span>self) ‑> requests.models.Response</span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="lupro.HTTPengine.engine.requests" href="#lupro.HTTPengine.engine.requests">engine.requests()</a></code> 为 <code>requests</code> 请求接口</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def requests(self) -&gt; Response:
    &#39;&#39;&#39;`engine.requests` 为 `requests` 请求接口&#39;&#39;&#39;
    res = requests.request(*self.args, **self.kw)
    return res</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="lupro.HTTPengine.lupro"><code class="flex name class">
<span>class <span class="ident">lupro</span></span>
<span>(</span><span>filename: str, lupros: <a title="lupro.hooks.lupros" href="hooks.html#lupro.hooks.lupros">lupros</a>, proxie: bool = False, format: str = 'html', content: int = 200, faultolt: int = 10)</span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="lupro.HTTPengine.lupro" href="#lupro.HTTPengine.lupro">lupro</a></code> 引擎基类</p>
<p>初始化 <code><a title="lupro.HTTPengine.lupro" href="#lupro.HTTPengine.lupro">lupro</a></code> 实例，一个实例代表一个请求或任务.</p>
<h2 id="args">Args</h2>
<p><code>filename</code> : <code>str</code> 文件路径或请求名称 推荐使用路径命名
<code>lupros</code> : <code>lupros</code> requests参数字典
<code>proxie</code> : <code>bool</code> 是否使用代理
<code>format</code> : <code>str</code> 保存文件格式
<code>content</code> : <code>int</code> 回调最少字节
<code>faultolt</code> : <code>int</code> 可重试次数</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class lupro(metaclass = inherit):
    &#39;&#39;&#39;`lupro` 引擎基类&#39;&#39;&#39;

    # 兼容 `requests`
    __general__ = HTTP_ENGINE

    # 当前文件夹
    onFile = RUNFILE

    # 代理池
    Proxies = PROXIES

    # 是否验证代理池
    VERIFY_PROXIES = VERIFY_PROXIES

    # 是否已验证代理
    IS_AGENT_VERIFIED = False

    def __init__(self, filename : str, lupros : lupros, proxie : bool = False, format : str = &#39;html&#39;, content : int = 200,faultolt : int = 10):
        &#39;&#39;&#39; 初始化 `lupro` 实例，一个实例代表一个请求或任务.

        Args:
            `filename` : `str` 文件路径或请求名称 推荐使用路径命名
            `lupros` : `lupros` requests参数字典
            `proxie` : `bool` 是否使用代理
            `format` : `str` 保存文件格式
            `content` : `int` 回调最少字节
            `faultolt` : `int` 可重试次数
        
        Returns:
            None
        &#39;&#39;&#39;
        self.filename = filename    # 文件路径或请求名称 推荐使用路径命名
        self.format = format        # 保存文件格式
        self.faultolt = faultolt    # 可重试次数
        self.proxie = proxie        # 是否使用代理
        self.content = content      # 回调最少字节
        self.lupros = lupros
        self.args = (lupros[0],*lupros[1])
        self.kw = copy(lupros[2])

        if (not lupro.Proxies) and self.proxie:
            lupro.Proxies = get_proxies()

        assert (not self.proxie) or (self.proxie and lupro.Proxies),&#39;`Proxies` cannot be empty!&#39;

        if not &#39;headers&#39; in self.kw:
            self.kw[&#39;headers&#39;] = {&#39;User-Agent&#39; : get_header()}
        elif not &#39;User-Agent&#39; in self.kw[&#39;headers&#39;]:
            self.kw[&#39;headers&#39;].update({&#39;User-Agent&#39; : get_header()})
        
        if lupro.VERIFY_PROXIES and self.proxie and (not lupro.IS_AGENT_VERIFIED):
            print(logging(&#39;开始验证代理！&#39;))
            t1 = datetime.now()
            self.authentication()
            lupro.IS_AGENT_VERIFIED = True
            print(logging(f&#39;用时{datetime.now() - t1}&#39;))
            print(logging(f&#34;高质量代理：{len(lupro.Proxies)}个！&#34;))

        if (not &#39;proxies&#39; in self.kw) and self.proxie:
            self.proxie = random.choice(lupro.Proxies)
            self.kw[&#39;proxies&#39;] = {&#39;http&#39;: f&#34;//{self.proxie}&#34;}
    
    # 验证代理
    def authentication(self) -&gt; None:
        &#39;&#39;&#39;`authentication` 为快速代理验证.&#39;&#39;&#39;

        auth_proxies = [gevent.spawn(verify_proxies, i) for i in lupro.Proxies]
        gevent.joinall(auth_proxies)
        lupro.Proxies = [i.value for i in auth_proxies if i.value]

    # 更新字典
    def renew_proxie(self):
        &#39;&#39;&#39;lupro实例 更新字典&#39;&#39;&#39;
        lupro.Proxies.remove(self.proxie)
        self.proxie = random.choice(lupro.Proxies)
        if lupro.__general__.__name__ == &#39;requests&#39;:
            self.kw[&#39;proxies&#39;] = {&#39;http&#39;: f&#34;//{self.proxie}&#34;}
        elif lupro.__general__.__name__ == &#39;httpx&#39;:
            self.kw[&#39;proxies&#39;] = {&#39;http://&#39;: f&#34;http://{self.proxie}&#34;}

    # 请求方法 lupro 所有请求
    @endurance
    def task(self):
        &#39;&#39;&#39;请求方法 lupro 所有请求接口&#39;&#39;&#39;
        def ask(self):
            if self.faultolt &lt;= 0:
                print(f&#39;{self.filename} failed.&#39;)
                return None
            print(logging(f&#34;{self.filename} {self.proxie} -----&gt; 开始请求！&#34;))
            try:
                res = getattr(engine, lupro.__general__.__name__)(self)
            except:
                if self.proxie and self.proxie in lupro.Proxies:
                    self.renew_proxie()
                self.faultolt -= 1
                print(logging(f&#34;{self.filename} -----&gt; 更新字典中！{self.faultolt}&#34;))
                return ask(self)
            if not res.status_code == 200:
                return ask(self)
            if len(res.content) &lt; self.content:
                return ask(self)
            print(logging(f&#34;{self.filename} {len(res.content)} -----&gt; 请求结束！&#34;)) 
            return res     
        return ask(self)
    
    # xpath 解析
    def xpath_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 xpath 解析方法.

        Args:
            `analytic` : `dict[str:str]` xpath解析字典
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.xpath(res, analytic, auxiliary)

    # json 解析
    def json_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 json 解析方法.

        Args:
            `analytic` : `dict[str:str]` xpath解析字典
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.json(res, analytic, auxiliary)

    # 正则 解析
    def re_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 正则 解析方法.

        Args:
            `analytic` : `dict`{`str`:`function`} 正则解析字典 
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.re(res, analytic, auxiliary)

    # css 解析
    def css_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
        &#39;&#39;&#39;实例 css 解析方法.

        Args:
            `analytic` : `dict[str:str]` css解析字典
            `auxiliary` : `function` 自定义解析处理
        
        Returns:
            dict : 解析字典
        &#39;&#39;&#39;
        res = self.task()
        if not res:
            return {}
        return analyze.css(res, analytic, auxiliary)

    # 保存文件路径
    def save_file(self) -&gt; str:
        &#39;&#39;&#39;保存文件方法，如果 `filename` 不为绝对路径,则保存文件的路径为当前目录&#39;&#39;&#39;

        res = self.task()
        if not res:
            return &#39;&#39;
        if os.path.isabs(self.filename):
            path = os.path.split(self.filename)[0]
        else:
            path = os.path.join(self.onFile,os.path.split(self.filename)[0])
        if not os.path.exists(path):
            os.makedirs(path)
        path = os.path.join(path,os.path.split(self.filename)[1]+f&#39;.{self.format}&#39;)
        if res.apparent_encoding == None:
            res.encoding = &#39;utf-8&#39;
        else:
            res.encoding = res.apparent_encoding
        with open(path,mode=&#39;wb&#39;) as f:
            f.write(res.content)
        return path

    def __repr__(self) -&gt; str:
        return f&#34;&lt;{__name__}.lupro({lupro.__general__.__name__}) object {self.filename}&gt;&#34;

    def __reprs__(self) -&gt; dict:
        &#39;&#39;&#39; `__reprs__` 为 `lupro` 实例化参数&#39;&#39;&#39;
        return {&#39;filename&#39;:self.filename ,&#39;format&#39;:self.format , &#39;proxie&#39;:self.proxie, &#39;faultolt&#39;:self.faultolt, &#39;content&#39; : self.content ,&#39;lupros&#39;:self.lupros}</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="lupro.HTTPengine.lupro.IS_AGENT_VERIFIED"><code class="name">var <span class="ident">IS_AGENT_VERIFIED</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="lupro.HTTPengine.lupro.Proxies"><code class="name">var <span class="ident">Proxies</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="lupro.HTTPengine.lupro.VERIFY_PROXIES"><code class="name">var <span class="ident">VERIFY_PROXIES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="lupro.HTTPengine.lupro.onFile"><code class="name">var <span class="ident">onFile</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="lupro.HTTPengine.lupro.authentication"><code class="name flex">
<span>def <span class="ident">authentication</span></span>(<span>self) ‑> NoneType</span>
</code></dt>
<dd>
<div class="desc"><p><code>authentication</code> 为快速代理验证.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def authentication(self) -&gt; None:
    &#39;&#39;&#39;`authentication` 为快速代理验证.&#39;&#39;&#39;

    auth_proxies = [gevent.spawn(verify_proxies, i) for i in lupro.Proxies]
    gevent.joinall(auth_proxies)
    lupro.Proxies = [i.value for i in auth_proxies if i.value]</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.lupro.css_analysis"><code class="name flex">
<span>def <span class="ident">css_analysis</span></span>(<span>self, analytic: dict, auxiliary=&lt;function original&gt;) ‑> dict</span>
</code></dt>
<dd>
<div class="desc"><p>实例 css 解析方法.</p>
<h2 id="args">Args</h2>
<p><code>analytic</code> : <code>dict[str:str]</code> css解析字典
<code>auxiliary</code> : <code>function</code> 自定义解析处理</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict </code></dt>
<dd>解析字典</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def css_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
    &#39;&#39;&#39;实例 css 解析方法.

    Args:
        `analytic` : `dict[str:str]` css解析字典
        `auxiliary` : `function` 自定义解析处理
    
    Returns:
        dict : 解析字典
    &#39;&#39;&#39;
    res = self.task()
    if not res:
        return {}
    return analyze.css(res, analytic, auxiliary)</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.lupro.json_analysis"><code class="name flex">
<span>def <span class="ident">json_analysis</span></span>(<span>self, analytic: dict, auxiliary=&lt;function original&gt;) ‑> dict</span>
</code></dt>
<dd>
<div class="desc"><p>实例 json 解析方法.</p>
<h2 id="args">Args</h2>
<p><code>analytic</code> : <code>dict[str:str]</code> xpath解析字典
<code>auxiliary</code> : <code>function</code> 自定义解析处理</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict </code></dt>
<dd>解析字典</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def json_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
    &#39;&#39;&#39;实例 json 解析方法.

    Args:
        `analytic` : `dict[str:str]` xpath解析字典
        `auxiliary` : `function` 自定义解析处理
    
    Returns:
        dict : 解析字典
    &#39;&#39;&#39;
    res = self.task()
    if not res:
        return {}
    return analyze.json(res, analytic, auxiliary)</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.lupro.re_analysis"><code class="name flex">
<span>def <span class="ident">re_analysis</span></span>(<span>self, analytic: dict, auxiliary=&lt;function original&gt;) ‑> dict</span>
</code></dt>
<dd>
<div class="desc"><p>实例 正则 解析方法.</p>
<h2 id="args">Args</h2>
<p><code>analytic</code> : <code>dict</code>{<code>str</code>:<code>function</code>} 正则解析字典
<code>auxiliary</code> : <code>function</code> 自定义解析处理</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict </code></dt>
<dd>解析字典</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def re_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
    &#39;&#39;&#39;实例 正则 解析方法.

    Args:
        `analytic` : `dict`{`str`:`function`} 正则解析字典 
        `auxiliary` : `function` 自定义解析处理
    
    Returns:
        dict : 解析字典
    &#39;&#39;&#39;
    res = self.task()
    if not res:
        return {}
    return analyze.re(res, analytic, auxiliary)</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.lupro.renew_proxie"><code class="name flex">
<span>def <span class="ident">renew_proxie</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>lupro实例 更新字典</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def renew_proxie(self):
    &#39;&#39;&#39;lupro实例 更新字典&#39;&#39;&#39;
    lupro.Proxies.remove(self.proxie)
    self.proxie = random.choice(lupro.Proxies)
    if lupro.__general__.__name__ == &#39;requests&#39;:
        self.kw[&#39;proxies&#39;] = {&#39;http&#39;: f&#34;//{self.proxie}&#34;}
    elif lupro.__general__.__name__ == &#39;httpx&#39;:
        self.kw[&#39;proxies&#39;] = {&#39;http://&#39;: f&#34;http://{self.proxie}&#34;}</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.lupro.save_file"><code class="name flex">
<span>def <span class="ident">save_file</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>保存文件方法，如果 <code>filename</code> 不为绝对路径,则保存文件的路径为当前目录</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_file(self) -&gt; str:
    &#39;&#39;&#39;保存文件方法，如果 `filename` 不为绝对路径,则保存文件的路径为当前目录&#39;&#39;&#39;

    res = self.task()
    if not res:
        return &#39;&#39;
    if os.path.isabs(self.filename):
        path = os.path.split(self.filename)[0]
    else:
        path = os.path.join(self.onFile,os.path.split(self.filename)[0])
    if not os.path.exists(path):
        os.makedirs(path)
    path = os.path.join(path,os.path.split(self.filename)[1]+f&#39;.{self.format}&#39;)
    if res.apparent_encoding == None:
        res.encoding = &#39;utf-8&#39;
    else:
        res.encoding = res.apparent_encoding
    with open(path,mode=&#39;wb&#39;) as f:
        f.write(res.content)
    return path</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.lupro.task"><code class="name flex">
<span>def <span class="ident">task</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>请求方法 lupro 所有请求接口</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@endurance
def task(self):
    &#39;&#39;&#39;请求方法 lupro 所有请求接口&#39;&#39;&#39;
    def ask(self):
        if self.faultolt &lt;= 0:
            print(f&#39;{self.filename} failed.&#39;)
            return None
        print(logging(f&#34;{self.filename} {self.proxie} -----&gt; 开始请求！&#34;))
        try:
            res = getattr(engine, lupro.__general__.__name__)(self)
        except:
            if self.proxie and self.proxie in lupro.Proxies:
                self.renew_proxie()
            self.faultolt -= 1
            print(logging(f&#34;{self.filename} -----&gt; 更新字典中！{self.faultolt}&#34;))
            return ask(self)
        if not res.status_code == 200:
            return ask(self)
        if len(res.content) &lt; self.content:
            return ask(self)
        print(logging(f&#34;{self.filename} {len(res.content)} -----&gt; 请求结束！&#34;)) 
        return res     
    return ask(self)</code></pre>
</details>
</dd>
<dt id="lupro.HTTPengine.lupro.xpath_analysis"><code class="name flex">
<span>def <span class="ident">xpath_analysis</span></span>(<span>self, analytic: dict, auxiliary=&lt;function original&gt;) ‑> dict</span>
</code></dt>
<dd>
<div class="desc"><p>实例 xpath 解析方法.</p>
<h2 id="args">Args</h2>
<p><code>analytic</code> : <code>dict[str:str]</code> xpath解析字典
<code>auxiliary</code> : <code>function</code> 自定义解析处理</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict </code></dt>
<dd>解析字典</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def xpath_analysis(self, analytic : dict, auxiliary = original) -&gt; dict:
    &#39;&#39;&#39;实例 xpath 解析方法.

    Args:
        `analytic` : `dict[str:str]` xpath解析字典
        `auxiliary` : `function` 自定义解析处理
    
    Returns:
        dict : 解析字典
    &#39;&#39;&#39;
    res = self.task()
    if not res:
        return {}
    return analyze.xpath(res, analytic, auxiliary)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="lupro" href="index.html">lupro</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="lupro.HTTPengine.engine" href="#lupro.HTTPengine.engine">engine</a></code></h4>
<ul class="">
<li><code><a title="lupro.HTTPengine.engine.httpx" href="#lupro.HTTPengine.engine.httpx">httpx</a></code></li>
<li><code><a title="lupro.HTTPengine.engine.requests" href="#lupro.HTTPengine.engine.requests">requests</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="lupro.HTTPengine.lupro" href="#lupro.HTTPengine.lupro">lupro</a></code></h4>
<ul class="two-column">
<li><code><a title="lupro.HTTPengine.lupro.IS_AGENT_VERIFIED" href="#lupro.HTTPengine.lupro.IS_AGENT_VERIFIED">IS_AGENT_VERIFIED</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.Proxies" href="#lupro.HTTPengine.lupro.Proxies">Proxies</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.VERIFY_PROXIES" href="#lupro.HTTPengine.lupro.VERIFY_PROXIES">VERIFY_PROXIES</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.authentication" href="#lupro.HTTPengine.lupro.authentication">authentication</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.css_analysis" href="#lupro.HTTPengine.lupro.css_analysis">css_analysis</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.json_analysis" href="#lupro.HTTPengine.lupro.json_analysis">json_analysis</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.onFile" href="#lupro.HTTPengine.lupro.onFile">onFile</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.re_analysis" href="#lupro.HTTPengine.lupro.re_analysis">re_analysis</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.renew_proxie" href="#lupro.HTTPengine.lupro.renew_proxie">renew_proxie</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.save_file" href="#lupro.HTTPengine.lupro.save_file">save_file</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.task" href="#lupro.HTTPengine.lupro.task">task</a></code></li>
<li><code><a title="lupro.HTTPengine.lupro.xpath_analysis" href="#lupro.HTTPengine.lupro.xpath_analysis">xpath_analysis</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>